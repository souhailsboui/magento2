<?xml version="1.0"?>
<!--
/**
 * Mageplaza
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Mageplaza.com license that is
 * available through the world-wide-web at this URL:
 * https://www.mageplaza.com/LICENSE.txt
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade this extension to newer
 * version in the future.
 *
 * @category    Mageplaza
 * @package     Mageplaza_AutoRelated
 * @copyright   Copyright (c) Mageplaza (https://www.mageplaza.com/)
 * @license     https://www.mageplaza.com/LICENSE.txt
 */
-->
<schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd">
    <table name="sales_order_item" resource="sales">
        <column xsi:type="text" name="arp_rule_token" nullable="true" comment="ARP Rule Token"/>
    </table>
    <table name="mageplaza_autorelated_block_rule" resource="default" engine="innodb"
           comment="Automatic Related Products Block Rule">
        <column xsi:type="int" name="rule_id" padding="10" unsigned="true" nullable="false" identity="true"
                comment="Rule Id"/>
        <column xsi:type="varchar" name="name" nullable="true" length="255" comment="Name"/>
        <column xsi:type="varchar" name="block_type" nullable="true" length="255" comment="Type"/>
        <column xsi:type="date" name="from_date" comment="From"/>
        <column xsi:type="date" name="to_date" comment="To"/>
        <column xsi:type="smallint" name="is_active" padding="6" unsigned="false" nullable="false" identity="false"
                default="0" comment="Is Active"/>
        <column xsi:type="mediumtext" name="conditions_serialized" nullable="true" comment="Conditions Serialized"/>
        <column xsi:type="mediumtext" name="actions_serialized" nullable="true" comment="Actions Serialized"/>
        <column xsi:type="varchar" name="category_conditions_serialized" nullable="true" length="255"
                comment="Category Conditions Serialized"/>
        <column xsi:type="int" name="sort_order" padding="10" unsigned="true" nullable="false" identity="false"
                default="0" comment="Sort Order"/>
        <column xsi:type="int" name="parent_id" padding="10" unsigned="true" nullable="false" identity="false"
                default="0" comment="Parent Rule ID"/>
        <column xsi:type="int" name="impression" padding="10" unsigned="true" nullable="false" identity="false"
                default="0" comment="Impression"/>
        <column xsi:type="int" name="click" padding="10" unsigned="true" nullable="false" identity="false" default="0"
                comment="Click Count"/>
        <column xsi:type="varchar" name="location" nullable="true" length="255" comment="Location"/>
        <column xsi:type="varchar" name="block_name" nullable="true" length="255" comment="Block Name"/>
        <column xsi:type="smallint" name="limit_number" padding="5" unsigned="true" nullable="false" identity="false"
                comment="Limit Number Of Products"/>
        <column xsi:type="smallint" name="display_out_of_stock" padding="6" unsigned="false" nullable="false"
                identity="false" default="0" comment="Display Out Of Stock Products"/>
        <column xsi:type="smallint" name="product_layout" padding="5" unsigned="true" nullable="false" identity="false"
                comment="Product Layout"/>
        <column xsi:type="smallint" name="sort_order_direction" padding="6" unsigned="false" nullable="false"
                identity="false" default="0" comment="Sort Order Direction"/>
        <column xsi:type="varchar" name="display_additional" nullable="true" length="255"
                comment="Display additional Information"/>
        <column xsi:type="text" name="add_ruc_product" nullable="true"
                comment="Add Related Up Sell Cross Sell Product"/>
        <column xsi:type="text" name="product_not_displayed" nullable="true" comment="Product is not displayed"/>
        <column xsi:type="int" name="total_impression" padding="10" unsigned="true" nullable="false" identity="false"
                default="0" comment="Total Impression"/>
        <column xsi:type="int" name="total_click" padding="10" unsigned="true" nullable="false" identity="false"
                default="0" comment="Total Click Count"/>
        <column xsi:type="smallint" name="display" padding="6" unsigned="false" nullable="false" identity="false"
                default="1" comment="Display" disabled="true"/>
        <column xsi:type="timestamp" name="created_at" on_update="false" nullable="false" default="CURRENT_TIMESTAMP"
                comment="Creation Time"/>
        <column xsi:type="timestamp" name="updated_at" on_update="true" nullable="false" default="CURRENT_TIMESTAMP"
                comment="Update Time"/>
        <column xsi:type="smallint" name="display_mode" padding="6" unsigned="false" nullable="true" identity="false"
                default="1" comment="Display type ajax or block"/>
        <column xsi:type="int" name="page_column_layout" padding="11" unsigned="false" nullable="true" identity="false"
                comment="Page Column Layout"/>
        <column xsi:type="int" name="number_product_slider" padding="11" unsigned="false" nullable="true"
                identity="false" comment="Number of products on Slider"/>
        <column xsi:type="int" name="number_product_scrolled" padding="11" unsigned="false" nullable="true"
                identity="false" comment="Product Displayed When Scrolled"/>
        <column xsi:type="smallint" name="apply_similarity" padding="6" unsigned="false" nullable="true"
                identity="false" comment="Product Displayed When Scrolled"/>
        <column xsi:type="mediumtext" name="similarity_actions_serialized" nullable="true"
                comment="Similarity Actions Serialized"/>
        <column xsi:type="text" name="token" nullable="true" comment="ARP Rule Token"/>
        <column xsi:type="int" name="show_see_all" padding="10" unsigned="true" nullable="false" identity="false"
                comment="Show See All Button"/>
        <column xsi:type="text" name="slider_config" nullable="true" comment="Show See All Button"/>
        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="rule_id"/>
        </constraint>
        <index referenceId="IDX_83453E19025284C9D7A1659E7C6D7BF3" indexType="btree">
            <column name="is_active"/>
            <column name="sort_order"/>
            <column name="to_date"/>
            <column name="from_date"/>
        </index>
    </table>
    <table name="mageplaza_autorelated_block_rule_store" resource="default" engine="innodb"
           comment="Auto Related Product To Stores Relations">
        <column xsi:type="int" name="rule_id" padding="10" unsigned="true" nullable="false" identity="false"
                comment="Rule Id"/>
        <column xsi:type="smallint" name="store_id" padding="5" unsigned="true" nullable="false" identity="false"
                comment="Store Id"/>
        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="rule_id"/>
            <column name="store_id"/>
        </constraint>
        <constraint xsi:type="foreign" referenceId="FK_1C29E7205B832065AF7B091B81F1C9BF"
                    table="mageplaza_autorelated_block_rule_store" column="rule_id"
                    referenceTable="mageplaza_autorelated_block_rule" referenceColumn="rule_id" onDelete="CASCADE"/>
        <constraint xsi:type="foreign" referenceId="MAGEPLAZA_AUTORELATED_BLOCK_RULE_STORE_STORE_ID_STORE_STORE_ID"
                    table="mageplaza_autorelated_block_rule_store" column="store_id" referenceTable="store"
                    referenceColumn="store_id" onDelete="CASCADE"/>
        <index referenceId="MAGEPLAZA_AUTORELATED_BLOCK_RULE_STORE_STORE_ID" indexType="btree">
            <column name="store_id"/>
        </index>
    </table>
    <table name="mageplaza_autorelated_block_rule_customer_group" resource="default" engine="innodb"
           comment="Auto Related Product To Customer Groups Relations">
        <column xsi:type="int" name="rule_id" padding="10" unsigned="true" nullable="false" identity="false"
                comment="Rule Id"/>
        <column xsi:type="int" name="customer_group_id" padding="10" unsigned="true" nullable="false" identity="false"
                default="0" comment="Customer Group Id"/>
        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="rule_id"/>
            <column name="customer_group_id"/>
        </constraint>
        <constraint xsi:type="foreign" referenceId="FK_9DBFD41551DC014BD7110F77F1D8BBC5"
                    table="mageplaza_autorelated_block_rule_customer_group" column="rule_id"
                    referenceTable="mageplaza_autorelated_block_rule" referenceColumn="rule_id" onDelete="CASCADE"/>
        <constraint xsi:type="foreign" referenceId="FK_7187B779604042EDCC080914FAB1881D"
                    table="mageplaza_autorelated_block_rule_customer_group" column="customer_group_id"
                    referenceTable="customer_group" referenceColumn="customer_group_id" onDelete="CASCADE"/>
        <index referenceId="MAGEPLAZA_AUTORELATED_BLOCK_RULE_CSTR_GROUP_CSTR_GROUP_ID" indexType="btree">
            <column name="customer_group_id"/>
        </index>
    </table>
    <table name="mageplaza_autorelated_actions_index" resource="default" engine="innodb"
           comment="Auto Related Product Actions Index">
        <column xsi:type="int" name="rule_id" padding="10" unsigned="true" nullable="false" identity="true"
                comment="Rule Id"/>
        <column xsi:type="int" name="product_id" padding="10" unsigned="true" nullable="false" identity="false"
                comment="Product Id"/>
        <constraint xsi:type="foreign" referenceId="FK_8C5D551AE5C17F76361F3FD9C77C4359"
                    table="mageplaza_autorelated_actions_index" column="rule_id"
                    referenceTable="mageplaza_autorelated_block_rule" referenceColumn="rule_id" onDelete="CASCADE"/>
        <constraint xsi:type="foreign" referenceId="MAGEPLAZA_AUTORELATED_ACTIONS_IDX_PRD_ID_CAT_PRD_ENTT_PRD_ID"
                    table="mageplaza_autorelated_actions_index" column="product_id"
                    referenceTable="catalog_product_entity" referenceColumn="entity_id" onDelete="CASCADE"/>
        <constraint xsi:type="unique" referenceId="MAGEPLAZA_AUTORELATED_ACTIONS_INDEX_RULE_ID_PRODUCT_ID">
            <column name="rule_id"/>
            <column name="product_id"/>
        </constraint>
    </table>
    <table name="mageplaza_autorelated_cms_page_rule" resource="default" engine="innodb"
           comment="mageplaza_autorelated_cms_page_rule">
        <column xsi:type="int" name="id" padding="10" unsigned="true" nullable="false" identity="true" comment="Id"/>
        <column xsi:type="int" name="rule_id" padding="10" unsigned="true" nullable="true" identity="false"
                comment="Rule Id"/>
        <column xsi:type="smallint" name="page_id" padding="6" unsigned="false" nullable="true" identity="false"
                comment="CMS Page Id"/>
        <column xsi:type="varchar" name="position" nullable="true" length="255" comment="Position"/>
        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="id"/>
        </constraint>
        <constraint xsi:type="foreign" referenceId="FK_CF45E60AEF4CE94280D2B9BB4D97503E"
                    table="mageplaza_autorelated_cms_page_rule" column="rule_id"
                    referenceTable="mageplaza_autorelated_block_rule" referenceColumn="rule_id" onDelete="CASCADE"/>
        <constraint xsi:type="foreign" referenceId="MAGEPLAZA_AUTORELATED_CMS_PAGE_RULE_PAGE_ID_CMS_PAGE_PAGE_ID"
                    table="mageplaza_autorelated_cms_page_rule" column="page_id" referenceTable="cms_page"
                    referenceColumn="page_id" onDelete="CASCADE"/>
    </table>
</schema>
